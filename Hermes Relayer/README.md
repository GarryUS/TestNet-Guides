
# Run a Relayer Hermes
This guide contains instructions on running a Hermes relayer, a Rust-based implementation.
</aside>

### ‚öô Hardware Requirements
-   16+ vCPUs or Intel or AMD 16 core CPU
-   at least 64GB RAM
-   4TB+ nVME drives

### üë®‚Äçüè≠ Prerequisites

1. Before beginning, ensure you have a [Nolus full node](https://www.notion.so/Run-a-Full-Node-7a92545223e7483bb4a02cce30b53aa8) and created a validator ([explorer](https://nolus.explorers.guru/validators)) . 
2. Install a Osmosis full node ([](https://docs.osmosis.zone/networks/join-testnet)[https://docs.osmosis.zone/networks/join-testnet](https://docs.osmosis.zone/networks/join-testnet) for a detailed setup guideline). The currently used version for the osmo-test-4 testnet binary is [v14.0.0-rc1](https://github.com/osmosis-labs/osmosis/releases/tag/v14.0.0-rc1).  
To install just run and follow the installer's instructions, desired node type - Pruned.
```bash	
curl -sL https://get.osmosis.zone/install > i.py && python3 i.py

# –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
journalctl -u cosmovisor -f -e

# In case of errors like
ERR  error="binary not present, downloading disabled: cannot stat dir /root/.osmosisd/cosmovisor/upgrades/v14/bin/osmosisd: stat /root/.osmosisd/cosmovisor/upgrades/v14/bin/osmosisd: no such file or directory" module=cosmovisor

# Create the required directory and copy the binary file into it
mkdir -p .osmosisd/cosmovisor/upgrades/v14/bin/
cp -p /root/go/bin/osmosisd ~/.osmosisd/cosmovisor/upgrades/v14/bin/
systemctl restart cosmovisor

# Make sure the Osmosis node is fully synchronized
osmosisd status 2>&1 | jq .SyncInfo

# Create wallet
osmosisd keys add <wallet name>

# Get OSMO via the Faucet - https://discord.com/channels/798583171548840026/911309363464007741
# Create Validator
osmosisd tx staking create-validator \
--from= <your wallet> \
--amount=70000000uosmo \
--pubkey=$(osmosisd tendermint show-validator)  \
--moniker="<your moniker>" \
--chain-id="osmo-test-4" \
--commission-rate=0.05 \
--commission-max-rate=0.20 \
--commission-max-change-rate=0.05 \
--min-self-delegation=1 
```
3. Check your Validator in [explorer](https://testnet.osmosis.explorers.guru/validators) .
4. Configure RPC, gRPC for full nodes Nolus and Osmosis.

### üåâ Installation and configuration Hermes

#### 1. Install Rust Dependencies

Since we are relying on a Rust-based implementation, we would need to install some Rust dependencies first:
```bash
curl --proto '=https' --tlsv1.2 -sSf <https://sh.rustup.rs> | sh

```

```bash
source "$HOME/.cargo/env"

```

```bash
sudo apt-get install pkg-config libssl-dev

```

```bash
sudo apt install librust-openssl-dev build-essential git

```

#### 2. Configure Hermes

Create the directory where you'll place the binary, clone the hermes source repository and build it using the latest release:

```bash
cargo install ibc-relayer-cli --bin hermes --locked
mkdir -p $HOME/hermes
git clone <https://github.com/informalsystems/ibc-rs.git> hermes
cd hermes
git checkout v1.2.0

```

Make a hermes ‚Äúkeys‚Äù directory, copy config.toml from the cloned repo to the .hermes directory:

```bash
mkdir -p $HOME/.hermes
mkdir -p $HOME/.hermes/keys
cp config.toml $HOME/.hermes

```

Check if hermes is installed properly by running:

```bash
hermes version

```

Edit the hermes **config.toml** file by including configurations for the two chains that you want to relay between, namely Nolus Rila testnet and Osmosis testnet:

```bash
nano $HOME/.hermes/config.toml

```
**Warning!**  Remove the generated by default ‚Äúchains‚Äù section with the example at the end of the file:
```
A chains section includes parameters related to a chain and the full node to which
the relayer can send transactions and queries.
[[chains]]
```
You would need to specify the hermes configurations for your two running nodes. 
–°onfig files below are set up for the following configuration (example):

 - –ûsmosis node is on server with Hermes (local 127.0.0.1). RPC/gRPC - 36657/39090 
 - Nolus node on the server 192.168.0.30. RPC/gRPC - 46657/49090

```
[[chains]]
id = 'nolus-rila'
rpc_addr = 'http://192.168.0.30:46657'
grpc_addr = 'http://192.168.0.30:49090'
websocket_addr = 'ws://192.168.0.30:46657/websocket'
rpc_timeout = '10s'
account_prefix = 'nolus'
key_name = 'hermes-nolus'
store_prefix = 'ibc'
default_gas = 1000000
max_gas = 4000000
gas_price = { price = 0.0025, denom = 'unls' }
gas_multiplier = 1.1
max_msg_num = 30
max_tx_size = 2097152
clock_drift = '5s'
max_block_time = '30s'
trusting_period = '14days'
trust_threshold = { numerator = '1', denominator = '3' }
address_type = { derivation = 'cosmos' }

[[chains]]
id = 'osmo-test-4'
rpc_addr = 'http://127.0.0.1:36657'
grpc_addr = 'http://127.0.0.1:39090'
websocket_addr = 'ws://127.0.0.1:36657/websocket'
rpc_timeout = '10s'
account_prefix = 'osmo'
key_name = 'hermes-osmosis'
store_prefix = 'ibc'
default_gas = 5000000
max_gas = 15000000
gas_price = { price = 0.0026, denom = 'uosmo' }
gas_multiplier = 1.1
max_msg_num = 20
max_tx_size = 209715
clock_drift = '20s'
max_block_time = '10s'
trusting_period = '10days'
trust_threshold = { numerator = '1', denominator = '3' }
address_type = { derivation = 'cosmos' }

```
#### 3. Wallet
Add your relayer wallet to hermes' keyring (located in `$HOME/.hermes/keys`). The wallet should have a positive balance on both the Nolus and the Osmosis networks since the relayer would need to pay gas fees to submit IBC transactions.

The best practice is to use the same mnemonic over all networks. Do not use your relaying addresses for anything else because it will lead to account sequence errors. 

Create this wallets:
```bash
# Nolus
nolusd keys add Relayer
# save mnemonic in file mnm.txt
```
```bash
#Osmosis, input saved mnemonic
osmosisd keys add Relayer --recover
```
```bash
#Hermes
hermes keys add --chain nolus-rila --mnemonic-file mnm.txt
hermes keys add --chain osmo-test-4 --mnemonic-file mnm.txt

```
Get OSMO and NLS via the Faucet for this wallets.

#### 4. Validate Configuration

Validate your `~/.hermes/config.toml` file by running:

```bash
hermes config validate

```

Perform a health check:

```bash
hermes health-check

```

You should see a similar output as the one below:

```bash
...
2023-03-06T13:56:25.116655Z  INFO ThreadId(01) using default configuration from '/root/.hermes/config.toml'
2023-03-06T13:56:25.118432Z  INFO ThreadId(01) running Hermes v1.3.0
2023-03-06T13:56:25.118506Z  INFO ThreadId(01) health_check{chain=nolus-rila}: performing health check...
2023-03-06T13:56:25.145851Z  WARN ThreadId(10) health_check{chain=nolus-rila}: Chain 'nolus-rila' has no minimum gas price value configured for denomination 'unls'. This is usually a sign of misconfiguration, please check your config.toml
2023-03-06T13:56:25.159913Z  INFO ThreadId(01) health_check{chain=nolus-rila}: chain is healthy
2023-03-06T13:56:25.159970Z  INFO ThreadId(01) health_check{chain=osmo-test-4}: performing health check...
2023-03-06T13:56:25.173391Z  WARN ThreadId(27) health_check{chain=osmo-test-4}: Chain 'osmo-test-4' has no minimum gas price value configured for denomination 'uosmo'. This is usually a sign of misconfiguration, please check your config.toml
2023-03-06T13:56:25.184554Z  INFO ThreadId(01) health_check{chain=osmo-test-4}: chain is healthy
SUCCESS performed health check for all chains in the config


```

#### 5. Run Hermes

If your nodes are fully synced, feel free to start the hermes daemon:

```bash
hermes start

```
#### 6. Check result
Wait 5-60 minutes. 
Check the Relayer addresses in the Nolus explorer and Osmosis explorer. examples of transactions that should be visible here:
https://nolus.explorers.guru/account/nolus1e3l56mwchrfcst2amh2sjrvurawr9mtf6yyga8
https://testnet.osmosis.explorers.guru/account/osmo1e3l56mwchrfcst2amh2sjrvurawr9mtfy088fs

**DONE!**
